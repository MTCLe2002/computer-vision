import numpy as np
from sklearn.linear_model import LinearRegression


class SequencePredictor:
    def __init__(self):
        self.model = LinearRegression()

    def fit(self, X, y):
        self.model.fit(X, y)

    def predict(self, X):
        return self.model.predict(X)

    def create_features(self, sequence, window_size):
        X = []
        y = []

        for i in range(len(sequence) - window_size - 1):
            X.append(sequence[i : i + window_size])
            y.append(sequence[i + window_size])

        return np.array(X), np.array(y).reshape(-1, 1)


import numpy as np


def main():
    sequence = np.array(
        [
            16705,
            49265,
            25649,
            75757,
            76191,
            45370,
            39597,
            20040,
            78014,
            81191,
            4942,
            18452,
            60762,
            62940,
            44221,
            48260,
            53363,
            45282,
            62857,
            91869,
            52371,
            34164,
            72859,
            87219,
            76479,
            16179,
            30061,
            34838,
            60755,
            52766,
            64948,
            6194,
            35492,
            18198,
            88864,
            29337,
            85120,
            98713,
            9841,
            41916,
            56141,
            18158,
            65243,
            18435,
            44971,
            37264,
            32775,
            90781,
            31357,
            1964,
            16979,
            30415,
            67360,
            93758,
            55827,
            76102,
            47577,
            37856,
            6743,
            58118,
            39919,
            75877,
            73787,
            68205,
            24420,
            47076,
            56695,
            17375,
            67879,
            67724,
            89581,
            59389,
            57570,
            86903,
            24192,
            81664,
            8798,
            45483,
            48657,
            32273,
            57765,
            83230,
            66228,
            86367,
            11504,
            59381,
            70344,
            1844,
            52333,
            75345,
            96226,
            89911,
            49736,
            29815,
            10026,
            6363,
            16039,
            37195,
            44265,
            57534,
            27414,
            41248,
            65576,
            71661,
            46285,
            24623,
            47914,
            64652,
            71679,
            42105,
            85483,
            89675,
            80755,
            13196,
            54639,
            90819,
            61820,
            865,
            85576,
            81918,
            82647,
            2904,
            88060,
            44481,
            58546,
            97996,
            63134,
            84102,
            19949,
            67753,
            90956,
            19031,
            67949,
            22632,
            22317,
            70452,
            45297,
            32754,
            95972,
            19966,
            20319,
            36191,
            96237,
            79459,
            85867,
            20765,
            88961,
            95921,
            71963,
            370,
            4408,
            81,
            83079,
            40357,
            13437,
            84288,
            1936,
            46260,
            55442,
            88661,
            57854,
            46904,
            76830,
            96361,
            94351,
            59915,
            51232,
            58534,
            84267,
            83660,
            9870,
            63634,
            3493,
            49195,
            97495,
            6920,
            69851,
            90746,
            57123,
            96894,
            6883,
            29397,
            44798,
            93076,
            98215,
            5408,
            58222,
            45631,
            67115,
            26902,
            78668,
            8897,
            51351,
            22406,
            20080,
            15339,
            58286,
            35944,
            27433,
            58062,
            62442,
            75659,
            87929,
            21171,
            40915,
            69358,
            55741,
            72615,
            4430,
            88137,
            80288,
            56177,
            45710,
            74923,
            8672,
            80766,
            59261,
            25102,
            90299,
            6848,
            84528,
            16893,
            41861,
            82019,
            79186,
            47887,
            41830,
            92009,
            27221,
            60279,
            63734,
            57973,
            82843,
            94958,
            18448,
            83185,
            49278,
            76551,
            73040,
            61379,
            6380,
            31186,
            8811,
            6367,
            15269,
            49956,
            13676,
            35252,
            35902,
            63768,
            73132,
            56650,
            59722,
            13720,
            11724,
            22365,
            43104,
            50925,
            40303,
            52566,
            22714,
            76922,
            62778,
            68779,
            45236,
            93447,
            11698,
            7044,
            19237,
            7289,
            80973,
            34556,
            53139,
            88733,
            73121,
            26547,
            75188,
            91245,
            84521,
            49140,
            50875,
            40620,
            59454,
            15013,
            94540,
            70876,
            28600,
            45305,
            42888,
            57349,
            91918,
            45844,
            91388,
            61380,
            26788,
            74036,
            7157,
            38050,
            34684,
            39267,
            20136,
            93127,
            65761,
            55858,
            13484,
            91484,
            10949,
            98526,
            34562,
            94670,
            8391,
            98375,
            19412,
            85800,
            33859,
            54869,
            95110,
            98371,
            38429,
            49071,
            17948,
            14670,
            57999,
            20952,
            8816,
            11873,
            84757,
            11913,
            3141,
            7426,
            12301,
            87485,
            1716,
            87694,
            47521,
            93178,
            35627,
            38223,
            57057,
            87360,
            38038,
            62970,
            91706,
            6245,
            36904,
            74825,
            3257,
            56732,
            14577,
            64978,
            88485,
            76711,
            51416,
            1243,
            8225,
            94636,
            74817,
            15131,
            36120,
            59380,
            73758,
            42932,
            10956,
            62495,
            10240,
            38267,
            72794,
            69618,
            91089,
            48877,
            73732,
            28285,
            13113,
            68586,
            91138,
            63261,
            95539,
            76553,
            54998,
            14609,
            70964,
            45819,
            36910,
            87441,
            61661,
            77375,
            20347,
            61579,
            68274,
            75346,
            8524,
            47666,
            87444,
            28174,
            33389,
            13300,
            69876,
            91267,
            67384,
            85852,
            39100,
            17670,
            48331,
            34864,
            58294,
            39903,
            75801,
            57406,
        ]
    )
    window_size = 1
    predictor = SequencePredictor()
    X, y = predictor.create_features(sequence, window_size)
    predictor.fit(X, y)

    new_sequence = np.array([4430]).reshape(1, -1)
    next_number = predictor.predict(new_sequence)

    print(f"The predicted next number is: {next_number[0][0]}")


if __name__ == "__main__":
    main()
